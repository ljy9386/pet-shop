  try {
    console.log("ğŸ”‘ ì†Œì…œ ë¡œê·¸ì¸ ì‹œë„:", userData);
    const res = await fetch("https://miraclepet.kr/api/auth/social-login", {
      method: "POST",
      headers: { 
        "Content-Type": "application/json",
        "Accept": "application/json"
      },
      credentials: 'include', // ì¿ í‚¤ í¬í•¨
      body: JSON.stringify({ user_id: userData.user_id })
    });

    console.log("ğŸ“¥ ì„œë²„ ì‘ë‹µ ìƒíƒœ:", res.status);
    const data = await res.json();
    console.log("ğŸ“¥ ì„œë²„ ì‘ë‹µ ë°ì´í„°:", data);

    if (!res.ok) {
      console.error("âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨:", data.message);
      errorMessage.textContent = data.message || "ë¡œê·¸ì¸ ì‹¤íŒ¨";
      return;
    }

    console.log("âœ… ë¡œê·¸ì¸ ì„±ê³µ:", data);

    // âœ… ë¡œê·¸ì¸ ìœ ì§€
    const userToStore = {
      ...data.user,
      isLoggedIn: true,
      sessionId: data.sessionId
    };
    console.log("ğŸ’¾ ì €ì¥í•  ì‚¬ìš©ì ì •ë³´:", userToStore);
    
    // localStorageì— ì €ì¥
    localStorage.setItem("user", JSON.stringify(userToStore));
    
    // sessionStorageì—ë„ ì €ì¥
    sessionStorage.setItem("user", JSON.stringify(userToStore));
    
    // ë¡œê·¸ í™•ì¸ì„ ìœ„í•œ ì§€ì—°
    await new Promise(resolve => setTimeout(resolve, 2000));
    
    console.log("ğŸ”„ í˜ì´ì§€ ì´ë™ ì „ ìµœì¢… ìƒíƒœ:", {
      localStorage: localStorage.getItem("user"),
      sessionStorage: sessionStorage.getItem("user"),
      cookies: document.cookie
    });
    
    alert("ë¡œê·¸ì¸ ì™„ë£Œ!");
    
    // í˜ì´ì§€ ì´ë™
    window.location.replace("index.html");
  } catch (err) {
    console.error("âŒ ë¡œê·¸ì¸ ì—ëŸ¬ ë°œìƒ:", err);
    console.error("ì—ëŸ¬ ìƒì„¸:", {
      message: err.message,
      stack: err.stack,
      name: err.name
    });
    errorMessage.textContent = "ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
  } 